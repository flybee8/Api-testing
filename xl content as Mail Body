import ms.versionimport platformimport smtplibfrom email.mime.text import MIMETextfrom email.mime.multipart import MIMEMultipartfrom email.mime.base import MIMEBasefrom email import encodersimport ms.versionms.version.addpkg("termcolor", "1.1.0")ms.version.addpkg("ConfigParser", "3.5.0b2")ms.version.addpkg('numpy', '1.11.2-py34')ms.version.addpkg('pandas', '0.19.2-py34')ms.version.addpkg('dateutil', '2.5.2-py34')ms.version.addpkg('xlrd', '1.0.0-py34')ms.version.addpkg('xlwt', '1.1.2-py34')ms.version.addpkg('openpyxl', '2.4.5-py34')ms.version.addpkg('prettytable', '0.7.2')ms.version.addpkg('jdcal', '1.0')ms.version.addpkg('et_xmlfile', '1.0.1')ms.version.addpkg('pytz', '2016.6.1')ms.version.addpkg('six', '1.10.0')ms.version.addpkg('tabulate', '0.7.7')import tabulateimport csvimport timeimport openpyxlimport osimport pandas as pdfrom openpyxl import load_workbookfrom prettytable import from_csv#Creating the DF & reading the data from csvexcelDF = pd.DataFrame()excelDF = pd.read_excel('T.xlsx',encoding='latin-1' 'Test_xl')msg=MIMEMultipart('alternative')Frm = 'rajesh.subramani@morganstanley.com't2 = 'rajesh.subramani@morganstanley.com'msg['Subject'] = 'Test mail-Python'msg['From'] = Frmmsg['To'] = t2email = '{excelDF}'email = email.format(excelDF=excelDF.to_html())part1=MIMEText(email,'html')msg.attach(part1)composed = msg.as_string()s=smtplib.SMTP('10.181.47.31')s.sendmail(msg['From'], msg['To'],msg.as_string())
